---
title: "Exploratory Analysis"
description: |
  DACSS 603 Final Project Work: "Analyzing Data"
categories:
  - statistics
  - final project
  - IT Army of Ukraine
author:
  - name: Kristina Becvar
date: 2022-04-24
output:
  distill::distill_article:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(dplyr)
library(ggplot2)
library(broom)
library(here)
```

# Data Sources

## DDOS User Observations

The primary data is a set of observations of users of a novice "hacking tool" to engage in DDOS (denial of service) attacks against Russian targets in March 2022. The data contains a total of users cumulatively for each day of the series March 2 through March 11, and the users represent participants from 98 counties.

## WVS/EVS

I will also be using a data set of observations from the World Values Survey conducted from 2017-2021 as a joint project between the World Values Survey and the European Values Studies. This data was released in July 2021, and contains responses from ~135,000 respondents among 95 countries.

## Spike/Newswhip

The third is a data set of media coverage (media articles and social media mentions) of the Ukrainian minister's call for volunteers for the "IT Army of Ukraine" to help fight the invasion of Russia on the digital front. 

# Background


# Hypothesis

I am looking at a model where the outcome is the number of DDOS attacks originated from a given country and explanatory variables are WVS activism scores, media coverage, and other controls.

# Data Analysis

## DDOS Users

The data I imported for this first exploration is a data frame consisting of 98 observations with the columns:

* Country Name
* Population (as indicated by the U.S. CIA World factbook website)
* Region (as indicated by the UN classifications)
* Cumulative total number of users of the DDOS attack tool from each representative country as of March 11, 2022

```{r code_folding = TRUE}
#load the data
ddos <- read_csv("cumulative_observations.csv")
#summarize the data
options(scipen = 999)
summary(ddos)
```

```{r code_folding = TRUE}
#load the data
ddos <- read_csv("active_observations.csv")
#assign column names to represent variables accurately
colnames(ddos) <- c("Country", "Population", "Region", "March2", "March3", "March4", "March5", "March6", "March7", "March8", "March9", "March10", "March11")
#summarize the data
options(scipen = 999)
head(ddos)
```

The total DDOS users as of the first day of observations, March 2, 2022, and the last day available for observation, March 11, 2022 began at 7,850 and grew to a total of 48,879.

```{r code_folding = TRUE}
sum(ddos$March2)
sum(ddos$March11)
```

However, I am not going to examine the panel data; I am only going to look at the cumulative data - or the count of users on the last day of observations, March 11.

It is still important to be able to visualize the dramatic change in user count over time, even if I am not analyzing the time series in this analysis.

```{r code_folding = TRUE}
regional_observations <- read_csv("regional_observations.csv", 
    col_types = cols(Date = col_date(format = "%m/%d/%Y")))
ddos_regions <- as_tibble(regional_observations) 

ggplot(ddos_regions, aes(x = Date)) +
  geom_line(aes(y = Africa, colour = "Africa")) +
  geom_line(aes(y = Central_America, colour = "Central America")) +
    geom_line(aes(y = Central_America, colour = "Central America")) +
    geom_line(aes(y = Central_Asia, colour = "Central Asia")) +
    geom_line(aes(y = Eastern_Europe, colour = "Eastern Europe")) +
    geom_line(aes(y = North_America, colour = "North America")) +
    geom_line(aes(y = Northern_Europe, colour = "Northern Europe")) +
    geom_line(aes(y = Oceania, colour = "Oceania")) +
    geom_line(aes(y = Southeastern_Asia, colour = "Southeastern Asia")) +
    geom_line(aes(y = South_America, colour = "South America")) +
    geom_line(aes(y = Southern_Europe, colour = "Southern Europe")) +
    geom_line(aes(y = Western_Asia, colour = "Western Asia")) +
    geom_line(aes(y = Western_Europe, colour = "Western Europe")) +
  scale_colour_discrete((name = "Region")) +
  xlab("Dates") +
  ylab("Users") +
  ggtitle("Increase in Users by Date") +
  theme_minimal()
```


```{r code_folding = TRUE}
daily_observations <- read_csv("daily_observations.csv", 
    col_types = cols(Date = col_date(format = "%m/%d/%Y")))
ddos_daily <- as_tibble(daily_observations) 

gg <- ggplot(ddos_regions, aes(x = Date)) +
  geom_line(aes(y = Total)) +
  xlab("Dates") +
  ylab("Users") +
  ggtitle("Increase in Users by Date") +
  theme_minimal()

gg

```

## Population & User Data

I'll start with a basic look at the relationship between the population of the countries and the number of users of DDOS attacks from the corresponding countries:

```{r code_folding=TRUE}
#create plot
ggplot(ddos, aes(x = log(Population), y = log(March11), color = Region)) +
  geom_point () +
  facet_wrap("Region")
```

## Linear Model of Population and Users

What I want to look at is the linear model of the relationship between the population of each country with participating users and the corresponding sample of users from that country.

I want to first simplify my data set

```{r code_folding=TRUE}
ddos_final <- read_csv("cumulative_observations.csv")
ddos_df <- ddos_final %>% 
  select(c(Population, Users))
library(cowplot)
gg1 <- ggplot(ddos_df, aes(x=Population, y=Users)) +
   geom_point() +
   geom_smooth(method=lm,se=TRUE,fullrange=TRUE,color="goldenrod") +
   labs(title= "Population and Users",
        x= "Population",
        y = "Users") +
    theme_minimal_hgrid()
gg1

```

```{r}
gg1b <- ggplot(ddos_df, aes(x=log(Population), y=log(Users))) +
  geom_point() +
  geom_smooth(method=lm,se=TRUE,fullrange=TRUE,color="goldenrod") +
   labs(title= "Log: Population and Users",
        x= "Population (log)",
        y = "Users (log)") +
   theme_minimal_hgrid()

gg1b
```


**It is clear that there is no correlation between a country's population and the number of users of the DDOS tool.**

# Loading IVS Data

The next data source I want to incorporate is the IVS data set. This brings in an overwhelming 135,000 observations of 231 variables. I selected the columns I am interested in working with and saved as a .csv file, which I will read in for the rest of the analysis.

To make matching easier, I used the "countrycode" package to assign proper country names to the ISO-3 numeric code from the data set.

```{r code_folding = TRUE}
#read in .dta file
#library(haven)
#ivs_data <- read_dta("data/ivs/ZA7505_v2-0-0.dta")
#head(ivs_data[33:42])
#write.csv(ivs_data, file = "./data/ivs/ivs_data.csv", row.names = TRUE)
#select relevant data
#ivs_subset <- select(ivs_data,10,34,35,40:50,106,109:114,119:138,150:162,166,188:196,199,201,210:214,222,224,225,230,231)
#ivs_df <- as.data.frame(ivs_subset)
#load package for converting country codes
#library(countrycode)
#ivs_df$country.name <- countrycode(ivs_df$cntry, origin = "iso3n", destination = "country.name")

rm(list = ls())
ivs_clean <- read.csv("ivs_df_names.csv")
ivs_clean <- as_tibble(ivs_clean)
names(ivs_clean)[1] <- 'country'
head(ivs_clean)
```

# Transforming IVS Data

## Importance to Respondents

There is some changes needed to make the data more manageable. I want to clean up some of the data by assigning all negative values representing various codes for no available observation to "NA" when applicable. 

```{r code_folding = TRUE}
important_na <- read.csv("important_na.csv")
important_na <- as_tibble(important_na)
names(important_na)[1] <- 'country'

#find mean of each column
important <- important_na %>%
  group_by(country) %>%
  summarise(
    family = mean(family, na.rm = TRUE),
    friends = mean(friends, na.rm = TRUE),
    leisure = mean(leisure, na.rm = TRUE),
    politics = mean(politics, na.rm = TRUE),
    work = mean(work, na.rm = TRUE),
    religion = mean(religion, na.rm = TRUE)
  )

summary(important)
```

## Political Inclinations of Respondents

```{r code_folding = TRUE}
#read in the 
politics_na <- read_csv("politics_na.csv", 
    col_types = cols(willing_fight = col_double(), 
        interest_politics = col_double(), 
        sign_petition = col_double(), join_boycott = col_double(), 
        attend_demonstration = col_double(), 
        join_strikes = col_double(), self_id = col_double()))
names(politics_na)[1] <- 'country'
#find mean of each column
politics <- politics_na %>%
  group_by(country) %>%
  summarise(
    willingness = mean(willing_fight, na.rm = TRUE),
    petition = mean(sign_petition, na.rm = TRUE),
    boycott = mean(join_boycott, na.rm = TRUE),
    demonstration = mean(attend_demonstration, na.rm = TRUE),
    strikes = mean(join_strikes, na.rm = TRUE),
    identity = mean(self_id, na.rm = TRUE)
  )

summary(politics)
```

## Demographics of Respondents

```{r code_folding = TRUE}
#read in the data
demographics_na <- read_csv("demographics_na.csv",
    col_types = cols(marital_status = col_double(), 
        live_parents = col_double(), children = col_double(), 
        household = col_double(), highest_ed = col_double(), 
        employment = col_double(), income = col_double()))
#find mean of each column
demographics <- demographics_na %>%
  group_by(country) %>%
  summarise(
    marital = mean(marital_status, na.rm = TRUE),
    parents = mean(live_parents, na.rm = TRUE),
    children = mean(children, na.rm = TRUE),
    household = mean(household, na.rm = TRUE),
    education = mean(highest_ed, na.rm = TRUE),
    income = mean(income, na.rm = TRUE)
  )

summary(demographics)
```

# Matching Data

When eliminating the countries who did not have a profile in the IVS dataset from my observation data, I lost approximately 2,000 observations. First I want to look at how this changes the distribution, if at all, among regions:

```{r code_folding = TRUE}
all_data <- read_csv("integrated_data.csv")
head(all_data)
```

# Multiple Linear Regression

## Importance to Respondents

```{r code_folding=TRUE}
#Linear regression of "importance" variables
mlm1 <- lm(users ~ family + friends + leisure + politics + work + religion, data = all_data, na.action = na.exclude)
summary(mlm1)
```

## Political Inclinations of Respondents

```{r code_folding=TRUE}
#Linear regression of "politics" variables
mlm2 <- lm(users ~ willingness + petition + boycott + demonstration + strikes + identity, data = all_data, na.action = na.exclude)
summary(mlm2)
```

## Demographics of Respondents

```{r code_folding=TRUE}
#Linear regression of "demographics" variables
mlm3 <- lm(users ~ marital + parents + children + household + education + income, data = all_data, na.action = na.exclude)
summary(mlm3)
```

# Simple Linear Regression

## Potential Correlation with Strike Propensity

I am going to look further at the potential correlation between countries with a propensity to engage in strikes and engage in DDOS attacks.

```{r code_folding=TRUE}
#Linear regression of "politics" variable "strikes"
lm_strikes <- lm(users ~ strikes, data = all_data, na.action = na.exclude)
summary(lm_strikes)
```

It may be that there are no correlations to be found here. But I want to run the analyses again using a column found in the codebook indicating 'weights' for population that should be used when comparing multiple variables to account for population size.

# Adding Population Weights

## Population to Users

I'll re-run the model with just population and users, but using the weights column:

```{r code_folding=TRUE}

lm_population_weighted <- lm(population ~ users, data = all_data, na.action = na.exclude, weights)
summary(lm_population_weighted)

```

## Importance to Respondents

```{r code_folding=TRUE}
#Linear regression of "importance" variables + weighted   
mlm1w <- lm(users ~ family + friends + leisure + politics + work + religion, data = all_data, na.action = na.exclude, weights)
summary(mlm1w)
```

## Political Inclinations of Respondents

```{r code_folding=TRUE}
#Linear regression of "politics" variables + weighted
mlm2w <- lm(users ~ willingness + petition + boycott + demonstration + strikes + identity, data = all_data, na.action = na.exclude, weights)
summary(mlm2w)
```

## Demographics of Respondents

```{r code_folding=TRUE}
#Linear regression of "demographics" variables + weighted
mlm3w <- lm(users ~ marital + parents + children + household + education + income, data = all_data, na.action = na.exclude, weights)
summary(mlm3w)
```




