---
title: "Further Analysis"
description: |
  DACSS 603 Final Project Work: "Further Analysis"
preview: education.png
categories:
  - statistics
  - quantitative data analysis
  - final project
  - IT Army of Ukraine
author:
  - name: Kristina Becvar
date: 2022-04-26
output:
  distill::distill_article:
    toc: true
    code_folding: true
    
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(plyr); library(dplyr)
library(ggplot2)
library(cowplot)
library(broom)
library(scales)
library(here)
```

# Reading in Data

Continuing this post by reading in the data I put together in my exploratory analysis. A full accounting of the variables and descriptions are in the "About" tab of this GitHub Page.

```{r code_folding = TRUE}
#all IVS data
ivs_clean <- read.csv("ivs-df-clean.csv")
ivs_clean <- as_tibble(ivs_clean)
names(ivs_clean)[1] <- 'country'
```

```{r code_folding = TRUE}
#integrated data
all_data <- read.csv("integrated_data.csv")
all_data <- as_tibble(all_data)
names(all_data)[1] <- 'country'
head(all_data)
```

# Multiple Linear Regression

## Importance to Respondents

```{r code_folding=TRUE}
#Linear regression of "importance" variables
mlm1 <- lm(users ~ family + friends + leisure + politics + work + religion, data = all_data, na.action = na.exclude)
summary(mlm1)
```

## Political Inclinations of Respondents

```{r code_folding=TRUE}
#Linear regression of "politics" variables
mlm2 <- lm(users ~ willingness + petition + boycott + demonstration + strikes + identity, data = all_data, na.action = na.exclude)
summary(mlm2)
```

## Demographics of Respondents

```{r code_folding=TRUE}
#Linear regression of "demographics" variables
mlm3 <- lm(users ~ marital + parents + children + household + education + income, data = all_data, na.action = na.exclude)
summary(mlm3)
```

## Users to Politics and Education

```{r code_folding=TRUE}
#Linear regression of "demographics" variables
mlm4 <- lm(users ~  politics + identity + education, data = all_data, na.action = na.exclude)
summary(mlm4)
```

# Simple Linear Regression

## Potential Correlation with Strike Propensity

I am going to look further at the potential correlation between countries with a propensity to engage in strikes and engage in DDOS attacks.

```{r code_folding=TRUE}
#Linear regression of "politics" variable "strikes"
lm_strikes <- lm(users ~ strikes, data = all_data, na.action = na.exclude)
summary(lm_strikes)
```

## Potential Correlation with Education Level

I am going to look further at the potential correlation between education level with a propensity to engage in strikes and engage in DDOS attacks.

```{r code_folding=TRUE}
#Linear regression of "educational level" and "users"
lm_education <- lm(users ~ education, data = all_data, na.action = na.exclude)
summary(lm_education)
```


It may be that there are no correlations to be found here. But I want to run the analyses again using a column found in the codebook indicating 'weights' for population that should be used when comparing multiple variables to account for population size.

# Adding Population Weights

## Importance to Respondents

I'll re-run the model with users and importance variables, but using the weights column. This gives me a warning that this is an "essentially perfect fit" and that the summary may be reliable. This result is consistent for each of the weighted models.

```{r code_folding=TRUE}
#Linear regression of "importance" variables + weighted   
mlm1w <- lm(users ~ family + friends + leisure + politics + work + religion, data = all_data, na.action = na.exclude, weights)
summary(mlm1w)
```

## Political Inclinations of Respondents

```{r code_folding=TRUE}
#Linear regression of "politics" variables + weighted
mlm2w <- lm(users ~ willingness + petition + boycott + demonstration + strikes + identity, data = all_data, na.action = na.exclude, weights)
summary(mlm2w)
```

## Demographics of Respondents

```{r code_folding=TRUE}
#Linear regression of "demographics" variables + weighted
mlm3w <- lm(users ~ marital + parents + children + household + education + income, data = all_data, na.action = na.exclude, weights)
summary(mlm3w)
```












# Working Data

This time I will start with the data frames with the observations I am looking at but not summarized by mean:

```{r code_folding = TRUE}
all_data <- read.csv("integrated_data.csv")
names(all_data)[1] <- 'country'
head(all_data)
```

Rather than just using a linear model, I want to look at some basic visualizations of relationships. I'll start by just looking at which countries have the highest mean values assigned by respondents to the question of how important politics is to them.

```{r code_folding=TRUE}
imp_plot <- arrange(all_data, desc(politics))
head(imp_plot)
```

Next, I'll use the "broom" package to look at the linear relationship between all variables and save it in a dataframe:

```{r code_folding=TRUE}
data_lm <- lm(users~family + friends + leisure + politics + work + religion, data = all_data, na.action = na.exclude)
tidylm_important <- tidy(data_lm)
tidylm_important
```

```{r code_folding=TRUE}
data_lm2 <- lm(users~willingness + petition + boycott + demonstration + strikes + identity, data = all_data, na.action = na.exclude)
tidylm_politics <- tidy(data_lm2)
tidylm_politics
```

```{r code_folding=TRUE}
data_lm3 <- lm(users~marital + parents + children + household + education + income, data = all_data, na.action = na.exclude)
tidylm_demographics <- tidy(data_lm3)
tidylm_demographics
```




```{r code_folding=TRUE}
all_data %>% 
  ggplot(aes(log(users), log(education))) +
  geom_point() +
  geom_smooth(method=lm,se=TRUE,fullrange=TRUE,color="goldenrod") +
    theme_minimal_hgrid()
```






